#d)
points(b.a,ret.a, pch = 19)
points(b.d,ret.d, pch = 19)
text(b.a, ret.a, labels = "Aggressive")
text(b.d,ret.d, labels = "Defensive")
a.a = ret.a - (rf+slope*b.a)
a.d = ret.b - (rf+slope*b.d)
alpha = c(a.a,a.d)
names(alpha) = c("aggressive", "defensive")
print(alpha)
plot(limit.b,limit.E, type = "l", xlim = c(0,3), ylim = c(0,0.4))
rf = 0.08
slope = ret.mkt-0.08
abline(rf,slope)
#d)
points(b.a,ret.a, pch = 19)
points(b.d,ret.d, pch = 19)
text(b.a, ret.a, labels = "Aggressive", pos = 3)
text(b.d,ret.d, labels = "Defensive", pos = 1)
a.a = ret.a - (rf+slope*b.a)
a.d = ret.b - (rf+slope*b.d)
alpha = c(a.a,a.d)
names(alpha) = c("aggressive", "defensive")
print(alpha)
plot(limit.b,limit.E, type = "l", xlim = c(0,3), ylim = c(0,0.4),
main = "Security Market Line")
rf = 0.08
slope = ret.mkt-0.08
abline(rf,slope)
#d)
points(b.a,ret.a, pch = 19)
points(b.d,ret.d, pch = 19)
text(b.a, ret.a, labels = "Aggressive", pos = 3)
text(b.d,ret.d, labels = "Defensive", pos = 1)
a.a = ret.a - (rf+slope*b.a)
a.d = ret.b - (rf+slope*b.d)
alpha = c(a.a,a.d)
names(alpha) = c("aggressive", "defensive")
print(alpha)
x=0
for (i in 1:20)
{
x = x+600000/(1.06^i)
}
x
x=0
for (i in 1:20)
{
x = x+600000/(1.08^i)
}
x
x=0
for (i in 1:20)
{
x = x+600000/(1.048^i)
}
x
x=0
for (i in 1:20)
{
x = x+600000/(1.04^i)
}
x
for (i in 1:10)
{
x = x+43500/(1.06^i)
}
x = x + 640000/1.06
x
for (i in 1:10)
{
x = x+43500/(1.06^i)
}
x = x + 640000/(1.06^10)
x
1.06^10
x=0
for (i in 1:10)
{
x = x+43500/(1.06^i)
}
x = x + 640000/(1.06^10)
x
1000000-x
setwd("C:/Users/Jiaqi Li/Desktop/404/hw4")
data = raed.csv("computats.csv")
data = read.csv("computats.csv")
sum(is.na(data))
len(data$ebitda)
length(data$ebitda)
length(data)
length(data$ebitda)
sum(is.na(data$gvkey))
sum(is.na(data$datadate))
sum(is.na(data$dltt))
data = read.csv("fundamental data.csv")
sum(is.na(data))
summary(data)
sum(is.na(data$ebitda))
length(data)
for (i in 1:16)
{
sum(is.na(data[,i]))
}
for (i in 1:16)
{
print(sum(is.na(data[,i])))
}
for (i in 1:16)
{
print(names(data)[i])
print(sum(is.na(data[,i])))
}
sum(is.na(data))
data.noNA = data[complete.cases(data)]
data.noNA = data[complete.cases(data),]
data = read.csv("data1.csv")
for (i in 1:16)
{
print(names(data)[i])
print(sum(is.na(data[,i])))
}
sum(is.na(data))
length(data$ebitda)
length(data)
12*201427
sum(complete.cases(data))
sum(！complete.cases(data))
data = read.csv("data1.csv")
data = read.csv("compustats.csv")
sum(complete.cases(data))
data = read.csv("compustats.csv")
sum(is.na(data))
data = read.csv("fundamental data.csv")
sum(complete.cases(data))
data = read.csv("fundamental data.csv")
sum(is.na(data))
sum(!complete.cases(data))
data.noNA = data[complete.cases(data),]
names(data.noNA)
MLR = (data.noNA$curcd+data.noNA$dltt)/data.noNA$at
data.noNA$curcd
MLR = (data.noNA$dlc+data.noNA$dltt)/data.noNA$at
hist(MLR)
data.noNA$at
data.noNA$dlc+data.noNA$dltt
BLR = (data.noNA$dlc+data.noNA$dltt)/(data.noNA$dlc+data.noNA$dltt+data$ceq)
data$ceq
length(data$ceq)
length(data$dltt)
BLR = (data.noNA$dlc+data.noNA$dltt)/(data.noNA$dlc+data.noNA$dltt+data.noNA$ceq)
hist(MLR)
hist(BLR)
?shit
?hist
hist(MLR)
for (i in 1:16)
{
print(names(data)[i])
print(sum(is.na(data[,i])))
}
hist(BLR,xlim = c(-1,1))
hist(BLR,xlim = c(-2,2))
hist(BLR,xlim = c(-10,10))
BLR
hist(BLR,xlim = c(-15,15))
hist(MLR)
(data.noNA$dlc+data.noNA$dltt+data.noNA$ceq)
(data.noNA$dlc+data.noNA$dltt)
(data.noNA$dlc+data.noNA$dltt+data.noNA$ceq)
mean(BLR)
BLR
BLR
hist(BLR)
BLR
mean(BLR)
(data.noNA$dlc+data.noNA$dltt+data.noNA$ceq)
mean(MLR)
data.noNA$ceq
BLR = (data.noNA$dlc+data.noNA$dltt)/(data.noNA$dlc+data.noNA$dltt+abs(data.noNA$ceq))
mean(BLR)
hist(BLR)
ss = 0
for (i in 1:length(data.noNA$dlc))
{
if (data.noNA == 0)
{
ss = ss + 1
}
}
ss = 0
for (i in 1:length(data.noNA$dlc))
{
if (data.noNA$dlc == 0)
{
ss = ss + 1
}
}
ss
ss = 0
for (i in 1:length(data.noNA$dlc))
{
if (data.noNA$dltt == 0)
{
ss = ss + 1
}
}
ss
length(data.noNA$dlc)
ss = 0
for (i in 1:length(data.noNA$dlc))
{
if (data.noNA$dltt[i] == 0)
{
ss = ss + 1
}
}
ss
ss = 0
for (i in 1:length(data.noNA$dlc))
{
if (data.noNA$dlc[i] == 0)
{
ss = ss + 1
}
}
ss
data.all = read.csv("data1.csv")
data.AllnoNA = data[complete.cases(data),]
MLR.all = (data.AllnoNA$dlc+data.AllnoNA$dltt)/data.AllnoNA$at
BLR.all = (data.AllnoNA$dlc+data.AllnoNA$dltt)/(data.AllnoNA$dlc+data.AllnoNA$dltt+abs(data.AllnoNA$ceq))
hist(MLR.all)
hist(BLR.all)
mean(MLR.all)
mean(BLR.all)
data.all = read.csv("data1.csv")
data.AllnoNA = dataAll[complete.cases(data),]
data.AllnoNA = dataAll[complete.cases(data.all),]
data.all = read.csv("data1.csv")
data.AllnoNA = data.all[complete.cases(data.all),]
MLR.all = (data.AllnoNA$dlc+data.AllnoNA$dltt)/data.AllnoNA$at
BLR.all = (data.AllnoNA$dlc+data.AllnoNA$dltt)/(data.AllnoNA$dlc+data.AllnoNA$dltt+abs(data.AllnoNA$ceq))
mean(MLR.all)
data.all = read.csv("data1.csv")
data.AllnoNA = data.all[complete.cases(data.all),]
MLR.all = (data.AllnoNA$dlc+data.AllnoNA$dltt)/data.AllnoNA$at
BLR.all = (data.AllnoNA$dlc+data.AllnoNA$dltt)/(data.AllnoNA$dlc+data.AllnoNA$dltt+abs(data.AllnoNA$ceq))
hist(MLR.all)
hist(BLR.all)
mean(MLR.all)
for (i in 1:length(data.AllnoNA$at))
{
if (data.AllnoNA$at[i] == 0)
{
data.AllnoNA[i] = NULL
}
}
data.AllnoNA = data.AllnoNA[which(data.AllnoNA$at == 0)]
data.all = read.csv("data1.csv")
data.AllnoNA = data.all[complete.cases(data.all),]
data.AllnoNA = data.AllnoNA[which(data.AllnoNA$at == 0)]
data.AllnoNA = data.AllnoNA[which(data.AllnoNA$at == 0),]
MLR.all = (data.AllnoNA$dlc+data.AllnoNA$dltt)/data.AllnoNA$at
BLR.all = (data.AllnoNA$dlc+data.AllnoNA$dltt)/(data.AllnoNA$dlc+data.AllnoNA$dltt+abs(data.AllnoNA$ceq))
mean(MLR.all)
mean(BLR.all)
hist(MLR)
hist(BLR)
print(paste("MLR mean: ", mean(MLR)))
print(paste("BLR mean: ", mean(BLR)))
summary(MLR)
summary(BLR)
hist(data.noNA$ebitda)
head(data.noNA$ebitda)
data2 = read.csv("data2.csv")
data2.noNA = data2[complete.cases(data2),]
MLR2 = (data2.noNA$dlc+data2.noNA$dltt)/data2.noNA$at
BLR2 = (data2.noNA$dlc+data2.noNA$dltt)/(data2.noNA$dlc+data2.noNA$dltt+abs(data2.noNA$ceq))
hist(MLR2)
hist(BLR2)
hist(MLR2)
plot(MLR2)
library(dplyr)
?group_by
mean(MLR2)
which(data2.noNA$at)
which(data2.noNA$at == 0)
data2.noNA = data2.noNA[which(data2.noNA == 0),]
MLR2 = (data2.noNA$dlc+data2.noNA$dltt)/data2.noNA$at
BLR2 = (data2.noNA$dlc+data2.noNA$dltt)/(data2.noNA$dlc+data2.noNA$dltt+abs(data2.noNA$ceq))
mean(MLR2)
sum(is.na(data2.noNA))
data2 = read.csv("data2.csv")
data2.noNA = data2[complete.cases(data2),]
sum(is.na(data2.noNA))
data2.noNA = data2.noNA[which(data2.noNA == 0),]
MLR2 = (data2.noNA$dlc+data2.noNA$dltt)/data2.noNA$at
BLR2 = (data2.noNA$dlc+data2.noNA$dltt)/(data2.noNA$dlc+data2.noNA$dltt+abs(data2.noNA$ceq))
mean(data2.noNA)
sum(is.na(data2.noNA$dlc))
data2 = read.csv("data2.csv")
data2.noNA = data2[is.na(data2$dlc),]
data2.noNA = data2[is.na(data2$dltt),]
data2.noNA = data2[is.na(data2$at),]
data2.noNA = data2[is.na(data2$ceq),]
data2.noNA = data2.noNA[which(data2.noNA == 0),]
data2.noNA = data2.noNA[which(data2.noNA$at == 0),]
MLR2 = (data2.noNA$dlc+data2.noNA$dltt)/data2.noNA$at
BLR2 = (data2.noNA$dlc+data2.noNA$dltt)/(data2.noNA$dlc+data2.noNA$dltt+abs(data2.noNA$ceq))
mean(MLR2)
sum(is.na(MLR2))
data2 = read.csv("data2.csv")
which(data2.noNA$at == 0)
which(data2.noNA$at == 0)
data2 = read.csv("data2.csv")
data2.noNA = data2[which(data2$at == 0),]
MLR2 = (data2.noNA$dlc+data2.noNA$dltt)/data2.noNA$at
BLR2 = (data2.noNA$dlc+data2.noNA$dltt)/(data2.noNA$dlc+data2.noNA$dltt+abs(data2.noNA$ceq))
mean(MLR2)
MLR2
data2.noNA$dlc
data2.noNA$dltt
data2 = read.csv("data2.csv")
MLR2 = (data2.noNA$dlc+data2.noNA$dltt)/data2.noNA$at
data2.noNA$dlc+data2.noNA$dltt
length(data2.noNA)
data2 = read.csv("data2.csv")
data2
which(data2$at == 0)
data2.noNA = data2[which(data2$at == 0),]
head(data2.noNA)
data2 = read.csv("data2.csv")
data2.noNA = data2[which(data2$at != 0),]
MLR2 = (data2.noNA$dlc+data2.noNA$dltt)/data2.noNA$at
BLR2 = (data2.noNA$dlc+data2.noNA$dltt)/(data2.noNA$dlc+data2.noNA$dltt+abs(data2.noNA$ceq))
mean(MLR2)
BLR2 = (data2.noNA$dlc+data2.noNA$dltt)/(data2.noNA$dlc+data2.noNA$dltt+abs(data2.noNA$ceq))
mean(BLR2)
hist(MLR2)
hist(BLR2)
hist(MLR2)
hist(BLR2)
boxplot(MLR2)
boxplot(BLR2)
boxplot(MLR2)
print(paste("MLR mean: ", mean(MLR2)))
print(paste("BLR mean: ", mean(BLR2)))
hist(data2.noNA$ebitda)
dataInd = group_by(data2.noNA,data2.noNA$indfmt)
head(dataInd)
names(dataInd)
dataInd$`data2.noNA$indfmt`
dataInd = data2.noNA %>% group_by(data2.noNA$spcindcd)
head(dataInd)
names(dataInd)
dataInd$`data2.noNA$spcindcd`
data2 = read.csv("data3.csv")
data2.noNA = data2[which(data2$at != 0),]
MLR2 = (data2.noNA$dlc+data2.noNA$dltt)/data2.noNA$at
BLR2 = (data2.noNA$dlc+data2.noNA$dltt)/(data2.noNA$dlc+data2.noNA$dltt+abs(data2.noNA$ceq))
hist(MLR2)
boxplot(MLR2)
hist(BLR2)
boxplot(BLR2)
print(paste("MLR mean: ", mean(MLR2)))
sum(is.na(data2.noNA))
data2 = read.csv("data3.csv")
data2 = data2[complete.cases(data2),]
data2.noNA = data2[which(data2$at != 0),]
MLR2 = (data2.noNA$dlc+data2.noNA$dltt)/data2.noNA$at
BLR2 = (data2.noNA$dlc+data2.noNA$dltt)/(data2.noNA$dlc+data2.noNA$dltt+abs(data2.noNA$ceq))
hist(MLR2)
boxplot(MLR2)
hist(BLR2)
boxplot(BLR2)
print(paste("MLR mean: ", mean(MLR2)))
print(paste("BLR mean: ", mean(BLR2)))
summary(MLR2)
summary(BLR2)
hist(data2.noNA$ebitda)
dataInd = data2.noNA %>% group_by(data2.noNA$gsector)
dataInd = data2.noNA %>% group_by(data2.noNA$gsector) %>% summarise(Ir_book = mean(Ir_book))
dataInd = data2.noNA %>% group_by(data2.noNA$gsector)
boxplot(dataInd)
boxplot(MLR2~data2.noNA$gsector)
boxplot(BLR2~data2.noNA$gsector)
dataInd = data2.noNA %>% group_by(data2.noNA$gsector) %>% summarise(MR = mean(MLR2))
dataInd
unique(data2.noNA$gsector)
?summarise
dataInd = data2.noNA %>% group_by(data2.noNA$gsector) %>% summarise(MLR2 = mean(MLR2))
dataInd = data2.noNA %>% group_by(data2.noNA$gsector) %>% summarise(MLR2 = mean(MLR2))
dataInd
dataInd = group_by(data2.noNA,data2.noNA$gsector)
dataInd$`data2.noNA$gsector`
head(data2.noNA)
dataInd$MR = MLR2
dataInd = data2.noNA %>% group_by(data2.noNA$gsector) %>% summarise(MLR2 = mean(MLR2))
dataInd
dataInd = data2.noNA %>% group_by(data2.noNA$gsector) %>% summarise(MR = mean(MR))
data2.noNA$MR = MLR2
dataInd = data2.noNA %>% group_by(data2.noNA$gsector) %>% summarise(MR = mean(MR))
dataInd
data2.noNA$BR = BLR2
dataIndB = data2.noNA %>% group_by(data2.noNA$gsector) %>% summarise(BR = mean(BR))
hist(dataIndM)
hist(dataIndM)
dataIndM = data2.noNA %>% group_by(data2.noNA$gsector) %>% summarise(MR = mean(MR))
dataIndB = data2.noNA %>% group_by(data2.noNA$gsector) %>% summarise(BR = mean(BR))
hist(dataIndM)
hist(dataIndM$MR)
boxplot(dataIndM$MR)
boxplot(dataIndM$MR)
boxplot(dataIndM)
boxplot(dataIndM$MR~dataIndM$`data2.noNA$gsector`)
names(data2.noNA)
ret = data2.noNA %>% group_by(data2.noNA$gsector) %>% summarise(ebitda = mean(ebitda))
ret
hist(MLR2)
boxplot(MLR2,breaks = 100)
hist(MLR2,breaks = 100)
hist(MLR2,breaks = 200)
hist(BLR2,,breaks = 200)
hist(MLR2,breaks = 200)
which(data2.noNA$dlc < 0)
which(data2.noNA$dlc !< 0)
hist(MLR2,breaks = 200)
MLR2 = (abs(data2.noNA$dlc)+abs(data2.noNA$dltt))/data2.noNA$at
hist(MLR2,breaks = 200)
hist(MLR2,breaks = 200, xlim = c(0,2))
hist(MLR2,breaks = 10000, xlim = c(0,2))
hist(MLR2,breaks = 1000, xlim = c(0,2))
hist(BLR2,breaks = 1000, xlim = c(0,2))
hist(BLR2,breaks = 200, xlim = c(0,2))
hist(BLR2,breaks = 200)
hist(MLR2,breaks = 1000, xlim = c(0,2))
hist(BLR2,breaks = 200)
hist(MLR2,breaks = 1000, xlim = c(0,2))
hist(MLR2,breaks = 200, xlim = c(0,2))
hist(MLR2,breaks = 10000, xlim = c(0,2))
hist(MLR2,breaks = 1000, xlim = c(0,2))
hist(MLR2,breaks = 5000, xlim = c(0,2))
hist(BLR2,breaks = 200)
print(paste("MLR mean: ", mean(MLR2)))
print(paste("BLR mean: ", mean(BLR2)))
boxplot(dataIndM$MR~dataIndM$`data2.noNA$gsector`)
boxplot(dataIndB$BR~dataIndB$`data2.noNA$gsector`)
?boxplot
ret
MLR2 = (abs(data2.noNA$dlc)+abs(data2.noNA$dltt))/data2.noNA$at
BLR2 = (abs(data2.noNA$dlc)+abs(data2.noNA$dltt))/(abs(data2.noNA$dlc)+abs(data2.noNA$dltt)+abs(data2.noNA$ceq))
hist(MLR2,breaks = 5000, xlim = c(0,2))
hist(BLR2,breaks = 200)
print(paste("MLR mean: ", mean(MLR2)))
print(paste("BLR mean: ", mean(BLR2)))
summary(MLR2)
summary(BLR2)
boxplot(BLR2~data2.noNA$gsector)
boxplot(MLR2~data2.noNA$gsector)
boxplot(BLR2~data2.noNA$gsector)
boxplot(MLR2~data2.noNA$gsector)
boxplot(BLR2~data2.noNA$gsector)
boxplot(ret$ebitda~ret$`data2.noNA$gsector`)
dataIndM = data2.noNA %>% group_by(data2.noNA$gsector) %>% summarise(MR = mean(MR), main = "Market Leverage Ratio")
dataIndM = data2.noNA %>% group_by(data2.noNA$gsector) %>% summarise(MR = mean(MR))
dataIndB = data2.noNA %>% group_by(data2.noNA$gsector) %>% summarise(BR = mean(BR))
boxplot(dataIndM$MR~dataIndM$`data2.noNA$gsector`, main = "Market Leverage Ratio")
boxplot(dataIndB$BR~dataIndB$`data2.noNA$gsector`, main = "Book Leverage Ratio")
boxplot(ret$ebitda~ret$`data2.noNA$gsector`, main = "Earning by Industry")
boxplot(MLR2~data2.noNA$gsector, main = "Market Leverage Ratio")
boxplot(BLR2~data2.noNA$gsector, main = "Book Leverage Ratio")
boxplot(dataIndM$MR~dataIndM$`data2.noNA$gsector`, main = "Mean Market Leverage Ratio")
boxplot(dataIndB$BR~dataIndB$`data2.noNA$gsector`, main = "Mean Book Leverage Ratio")
boxplot(ret$ebitda~ret$`data2.noNA$gsector`, main = "Mean Earning by Industry")
boxplot(MLR2~data2.noNA$gsector, main = "Market Leverage Ratio")
boxplot(BLR2~data2.noNA$gsector, main = "Book Leverage Ratio")
hist(MLR2,breaks = 5000, xlim = c(0,2), main = "Market Leverage Ratio")
hist(BLR2,breaks = 200, main = "Book Leverage Ratio")
summary(MLR2)
summary(BLR2)
MLR2 = (abs(data2.noNA$dlc)+abs(data2.noNA$dltt))/abs(data2.noNA$at)
BLR2 = (abs(data2.noNA$dlc)+abs(data2.noNA$dltt))/(abs(data2.noNA$dlc)+abs(data2.noNA$dltt)+abs(data2.noNA$ceq))
hist(MLR2,breaks = 5000, xlim = c(0,2), main = "Market Leverage Ratio")
hist(BLR2,breaks = 200, main = "Book Leverage Ratio")
print(paste("MLR mean: ", mean(MLR2)))
print(paste("BLR mean: ", mean(BLR2)))
summary(MLR2)
summary(BLR2)
hist(MLR2,breaks = 5000, xlim = c(0,2), main = "Market Leverage Ratio")
hist(BLR2,breaks = 200, main = "Book Leverage Ratio")
boxplot(MLR2~data2.noNA$gsector, main = "Market Leverage Ratio")
boxplot(BLR2~data2.noNA$gsector, main = "Book Leverage Ratio")
boxplot(dataIndM$MR~dataIndM$`data2.noNA$gsector`, main = "Mean Market Leverage Ratio")
boxplot(dataIndB$BR~dataIndB$`data2.noNA$gsector`, main = "Mean Book Leverage Ratio")
boxplot(ret$ebitda~ret$`data2.noNA$gsector`, main = "Mean Earning by Industry")
plot(data2.noNA$gsector, MLR2, main = "Market Leverage Ratio")
plot( dataIndM$`data2.noNA$gsector`, dataIndM$MR,main = "Mean Market Leverage Ratio")
plot(dataIndB$`data2.noNA$gsector`, dataIndB$BR, main = "Mean Book Leverage Ratio")
plot(ret$`data2.noNA$gsector`, ret$ebitda, main = "Mean Earning by Industry")
summary(MLR2)
summary(BLR2)
summary(data2.noNA$oancf)
summary(data2.noNA$ivncf)
summary(data2.noNA$fincf)
summary(data2.noNA$ebitda)
dataIndB
ret
mean(MLR2)
mean(BLR2)
mean(dataIndB)
mean(dataIndB$BR)
mean(dataIndM$MR)
